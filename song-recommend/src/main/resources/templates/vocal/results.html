<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <title>Results</title>
</head>
<body>
<h2>노래 추천 결과</h2>
<table style="width:100%">
    <tr>
        <th>Title</th>
        <th>Artist</th>
        <th>Gender</th>
    </tr>
</table>
<button th:onclick="|location.href = '/'|">Restart</button>

<!--<script th:src="@{/js/results.js}"></script>-->
<script>
    console.log("작은값" + lowNote)
    console.log("큰값" + highNote)
</script>
<script>
    window.onload = function() {
        let lowNote = sessionStorage.getItem('lowNote');
        let highNote = sessionStorage.getItem('highNote');

        console.log("작은값: " + lowNote);
        console.log("큰값: " + highNote);

        let data = {
            lowest_Note: lowNote,
            highest_Note: highNote
        };

        fetch('/getnote', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response 오류');
                }
                return response.json();
            })
            .then(data => {
                console.log('Received data:', data);
                let table = document.querySelector('table');
                let row = table.insertRow();
                let titleCell = row.insertCell();
                let artistCell = row.insertCell();
                let genderCell = row.insertCell();

                titleCell.innerText = data.title;
                artistCell.innerText = data.artist;
                genderCell.innerText = data.gender;
            })
            .catch(error => {
                console.error('오류남:', error);
            });
    };
</script>
</body>
</html>
